<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Getting Started • ERA5Flux</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Getting Started">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ERA5Flux</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item"><a class="nav-link" href="../articles/ERA5Flux.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/Malone-Disturbance-Ecology-Lab/ERA5Flux/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Getting Started</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/Malone-Disturbance-Ecology-Lab/ERA5Flux/blob/main/vignettes/ERA5Flux.Rmd" class="external-link"><code>vignettes/ERA5Flux.Rmd</code></a></small>
      <div class="d-none name"><code>ERA5Flux.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="intro">Intro<a class="anchor" aria-label="anchor" href="#intro"></a>
</h2>
<p>This package was designed to make it easier to work with both <a href="https://www.ecmwf.int/en/forecasts/dataset/ecmwf-reanalysis-v5" class="external-link">ERA5</a>
and <a href="https://ameriflux.lbl.gov/" class="external-link">AmeriFlux</a> data, hence the
name “ERA5Flux”. There may be instances where the AmeriFlux data contain
gaps that you want to fill with ERA5 data to create a single time series
for your analysis.</p>
<p>Here is a demonstration of the workflow needed to achieve that
result.</p>
</div>
<div class="section level2">
<h2 id="workflow">Workflow<a class="anchor" aria-label="anchor" href="#workflow"></a>
</h2>
<div class="section level3">
<h3 id="step-0-get-ameriflux-data-and-site-metadata">Step 0: Get AmeriFlux data and site metadata<a class="anchor" aria-label="anchor" href="#step-0-get-ameriflux-data-and-site-metadata"></a>
</h3>
<p>First we will need to download AmeriFlux data. Navigate to <a href="https://ameriflux.lbl.gov/" class="external-link">AmeriFlux</a> and login to your
account. Once you’re logged in, you can download data at the <a href="https://ameriflux.lbl.gov/data/download-data/" class="external-link">Download
page</a>.</p>
<p>You will be presented with options on the types of data products you
would like to download. Select <strong>AmeriFlux BASE</strong> then
select <strong>CC-BY-4.0</strong> as the data use policy that you will
follow. At the next step, pick the sites that you would like, then write
a short description of your intended use for this data and agree to the
license.</p>
<p>Finally, you will be presented with a data download page that has
download links for the requested sites. Click on those download links to
get a zip file for each site. You will also need to click on the
“Requested_Files” download link to get the metadata text file for your
request. This will download as
“requested_files_manifest_YYYYMMDD.txt”.</p>
<p>After you’ve downloaded everything, unzip the site zip files. To
ensure that the rest of the workflow runs smoothly, we recommend that
you arrange your files like so:</p>
<pre><code>your-working-directory/
├── unzipped_AmeriFlux_data/          
│   ├── unzipped_site1_folder/  
│   │   ├── *.csv
│   │   └── *.xlsx
│   │
│   ├── unzipped_site2_folder/
│   │   ├── *.csv
│   │   └── *.xlsx
│   │
│   ├── unzipped_site3_folder/
│   │   ├── *.csv
│   │   └── *.xlsx
│   │
│   └── requested_files_manifest_YYYYMMDD.txt
│
├── site1_data.zip  
├── site2_data.zip 
├── site3_data.zip 
│
└── more stuff/               
    ├── ...   
    └── ...</code></pre>
<p>After arranging the files, you can now generate the AmeriFlux site
metadata. In this example, the folder called
<code>unzipped_AmeriFlux_data</code> contains the unzipped site folders
and requested files manifest.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load the package</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/Malone-Disturbance-Ecology-Lab/ERA5Flux" class="external-link">ERA5Flux</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Specify the ERA5 variables you want to get</span></span>
<span><span class="va">my_variables</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"surface_solar_radiation_downwards"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Point to the folder containing the unzipped site folders and requested files manifest</span></span>
<span><span class="va">my_folder</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"unzipped_AmeriFlux_data"</span>, package <span class="op">=</span> <span class="st">"ERA5Flux"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Generate the AmeriFlux site metadata file</span></span>
<span><span class="va">my_site_metadata</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_site_metadata.html">get_site_metadata</a></span><span class="op">(</span>folder <span class="op">=</span> <span class="va">my_folder</span>,</span>
<span>                                      selected_variables <span class="op">=</span> <span class="va">my_variables</span><span class="op">)</span></span>
<span><span class="co">#&gt; selected variables: surface_solar_radiation_downwards</span></span>
<span><span class="co">#&gt; Now checking: US-GL2</span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">Rows: </span><span style="color: #0000BB;">7248</span> <span style="font-weight: bold;">Columns: </span><span style="color: #0000BB;">1</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Column specification</span> <span style="color: #00BBBB;">────────────────────────────────────────────────────────</span></span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">Delimiter:</span> ","</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">dbl</span> (1): TIMESTAMP_START</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Use `spec()` to retrieve the full column specification for this data.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Specify the column types or set `show_col_types = FALSE` to quiet this message.</span></span>
<span></span>
<span><span class="va">my_site_metadata</span></span>
<span><span class="co">#&gt;   site_codes     lat      lon   startdate      enddate</span></span>
<span><span class="co">#&gt; 1     US-GL2 46.7167 -87.4000 2.02501e+11 202505312330</span></span>
<span><span class="co">#&gt;                           variables</span></span>
<span><span class="co">#&gt; 1 surface_solar_radiation_downwards</span></span></code></pre></div>
<p>The metadata dataframe will have 5 columns: <code>site_codes</code>,
<code>lat</code>, <code>lon</code>, <code>startdate</code>,
<code>enddate</code>, and <code>variables</code>. We will need this
metadata in order to build our ERA5 data requests.</p>
</div>
<div class="section level3">
<h3 id="step-1-download-era5-data">Step 1: Download ERA5 Data<a class="anchor" aria-label="anchor" href="#step-1-download-era5-data"></a>
</h3>
<p>After you get the AmeriFlux site metadata, you can now go ahead and
download ERA5 data.</p>
<p>But before that, there are a few steps you need to do.</p>
<p>First, make sure you create an account at the <a href="https://cds.climate.copernicus.eu/" class="external-link">Copernicus Climate Data
Store</a> if you haven’t done so already. You may need to accept the
data license agreement first before you can download the data. Visit the
<a href="https://cds.climate.copernicus.eu/profile" class="external-link">Climate Data Store
User Profile page</a> to accept the appropriate license(s).</p>
<p>Then, <code><a href="../reference/download_ERA5.html">download_ERA5()</a></code> requires a land-sea mask so you
must download that first with <code><a href="../reference/get_land_sea_mask.html">get_land_sea_mask()</a></code>. This
function will download the land-sea mask from <a href="https://confluence.ecmwf.int/pages/viewpage.action?pageId=140385202#ERA5Land:datadocumentation-parameterlistingParameterlistings" class="external-link">here</a></p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Download the land-sea mask if you haven't done so already</span></span>
<span><span class="fu"><a href="../reference/get_land_sea_mask.html">get_land_sea_mask</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>Now you are ready to download ERA5 data. Copy and paste your Climate
Data Store API token into the <code>my_token</code> argument. Provide
the AmeriFlux site metadata in <code>site_metadata</code>, and set the
file path to your land-sea mask as well. Finally, specify a folder path
to where you want to download your ERA5 data to.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Paste your token </span></span>
<span><span class="va">my_token</span> <span class="op">&lt;-</span> <span class="st">"my_ECMWF_token"</span></span>
<span></span>
<span><span class="co"># Set the path to your land-sea mask</span></span>
<span><span class="va">path_to_mask</span> <span class="op">&lt;-</span> <span class="st">"lsm_1279l4_0.1x0.1.grb_v4_unpack.nc"</span></span>
<span></span>
<span><span class="co"># Point to the folder where you want the ERA5 data to download to</span></span>
<span><span class="va">my_download_path</span> <span class="op">&lt;-</span> <span class="st">"path_to_ERA5_download_folder"</span></span>
<span></span>
<span><span class="co"># Download the ERA5 data</span></span>
<span><span class="fu"><a href="../reference/download_ERA5.html">download_ERA5</a></span><span class="op">(</span>my_token <span class="op">=</span> <span class="va">my_token</span>,</span>
<span>              site_metadata <span class="op">=</span> <span class="va">my_site_metadata</span>,</span>
<span>              mask <span class="op">=</span> <span class="va">path_to_mask</span>,</span>
<span>              download_path <span class="op">=</span> <span class="va">my_download_path</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="step-2-data-processing">Step 2: Data Processing<a class="anchor" aria-label="anchor" href="#step-2-data-processing"></a>
</h3>
<p>After downloading the ERA5 .nc files, we convert them into CSV files
formatted to match AmeriFlux standards, enabling easy merging with
existing datasets. This conversion is handled by
<code><a href="../reference/netcdf_df_formatter.html">netcdf_df_formatter()</a></code>, which adjusts ERA5 timestamps from
UTC to local time (yyyyMMddHHmm) based on each site’s coordinates and
converts solar radiation (ssrd), air temperature (t2m), and total
precipitation (tp) to AmeriFlux units. The <code><a href="../reference/netcdf_to_csv.html">netcdf_to_csv()</a></code>
function then calls <code><a href="../reference/netcdf_df_formatter.html">netcdf_df_formatter()</a></code> for each site
folder, merging all relevant data by site and year so that each output
CSV contains one site’s data for one year. If
<code>full_year = TRUE</code>, the function will only return full years
that begin with the first hour of the year and end with the last. For
the purposes of this example, set <code>full_year = FALSE</code>.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Point to a folder containing ERA5 .nc files</span></span>
<span><span class="va">site_folder</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"path_to_ERA5_download_folder"</span>, package <span class="op">=</span> <span class="st">"ERA5Flux"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Specify a site name</span></span>
<span><span class="va">site_name</span> <span class="op">&lt;-</span> <span class="st">"US_GL2"</span></span>
<span></span>
<span><span class="co"># Create a temporary directory to export our output to</span></span>
<span><span class="va">output_filepath</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Convert NetCDF data to a CSV file</span></span>
<span><span class="fu"><a href="../reference/netcdf_to_csv.html">netcdf_to_csv</a></span><span class="op">(</span><span class="va">site_folder</span>, <span class="va">output_filepath</span>, <span class="va">site_name</span>, full_year <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt; Saved: US_GL2_2024_2025_ssrd.csv</span></span>
<span></span>
<span><span class="co"># Read the CSV back in</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span><span class="va">output_filepath</span>, pattern <span class="op">=</span> <span class="st">"US_GL2"</span>, full.names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span>
<span><span class="co">#&gt;           time     ssrd</span></span>
<span><span class="co">#&gt; 1 202412311900 663.4275</span></span>
<span><span class="co">#&gt; 2 202412312000   0.0000</span></span>
<span><span class="co">#&gt; 3 202412312100   0.0000</span></span>
<span><span class="co">#&gt; 4 202412312200   0.0000</span></span>
<span><span class="co">#&gt; 5 202412312300   0.0000</span></span>
<span><span class="co">#&gt; 6 202501010000   0.0000</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="step-3-merging-and-blending-ameriflux-with-era5-data">Step 3: Merging and Blending AmeriFlux with ERA5 Data<a class="anchor" aria-label="anchor" href="#step-3-merging-and-blending-ameriflux-with-era5-data"></a>
</h3>
<p>After you processed the ERA5 data, you can merge it with the
AmeriFlux data.</p>
<p>The <code><a href="../reference/merge_ERA5_FLUX.html">merge_ERA5_FLUX()</a></code> function synchronizes AmeriFlux
tower observations with ERA5 reanalysis data, ensuring both datasets
share consistent timestamps and comparable variable names. It first
reads AmeriFlux BASE data, replaces missing values with <code>NA</code>,
and imports the processed ERA5 CSV file generated from
<code><a href="../reference/netcdf_to_csv.html">netcdf_to_csv()</a></code>. Because ERA5 data are typically hourly and
AmeriFlux data are often half-hourly, the function linearly interpolates
ERA5 variables to match the AmeriFlux time step. It then merges the
datasets based on the aligned time column, adding corresponding
AmeriFlux and ERA5 variables side by side. The resulting dataframe
provides a harmonized, site-specific time series that researchers can
use to compare reanalysis and in situ flux measurements, fill short data
gaps, and prepare blended climate–flux inputs for ecosystem or
hydrological modeling.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Point to AmeriFlux data</span></span>
<span><span class="va">ameriflux_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"AMF_US-GL2_BASE-BADM_1-5.zip"</span>, package <span class="op">=</span> <span class="st">"ERA5Flux"</span><span class="op">)</span></span>
<span><span class="co"># Point to ERA5 data</span></span>
<span><span class="va">era5_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span><span class="va">output_filepath</span>, pattern <span class="op">=</span> <span class="st">"US_GL2"</span>, full.names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># List AmeriFlux variable(s) to be merged </span></span>
<span><span class="va">ameriflux_var</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"SW_IN"</span><span class="op">)</span></span>
<span><span class="co"># List ERA5 variable(s) to be merged </span></span>
<span><span class="va">era5_var</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ssrd"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Merge them together</span></span>
<span><span class="va">merged_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/merge_ERA5_FLUX.html">merge_ERA5_FLUX</a></span><span class="op">(</span>filename_FLUX <span class="op">=</span> <span class="va">ameriflux_file</span>,</span>
<span>                               filename_ERA5 <span class="op">=</span> <span class="va">era5_file</span>,</span>
<span>                               varname_FLUX <span class="op">=</span> <span class="va">ameriflux_var</span>,</span>
<span>                               varname_ERA5 <span class="op">=</span> <span class="va">era5_var</span><span class="op">)</span></span>
<span></span>
<span><span class="va">merged_data</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">20</span>,<span class="op">]</span></span>
<span><span class="co">#&gt;                   time     ssrd SW_IN</span></span>
<span><span class="co">#&gt; 1  2024-12-31 19:00:00 663.4275    NA</span></span>
<span><span class="co">#&gt; 2  2024-12-31 19:30:00 331.7138    NA</span></span>
<span><span class="co">#&gt; 3  2024-12-31 20:00:00   0.0000    NA</span></span>
<span><span class="co">#&gt; 4  2024-12-31 20:30:00   0.0000    NA</span></span>
<span><span class="co">#&gt; 5  2024-12-31 21:00:00   0.0000    NA</span></span>
<span><span class="co">#&gt; 6  2024-12-31 21:30:00   0.0000    NA</span></span>
<span><span class="co">#&gt; 7  2024-12-31 22:00:00   0.0000    NA</span></span>
<span><span class="co">#&gt; 8  2024-12-31 22:30:00   0.0000    NA</span></span>
<span><span class="co">#&gt; 9  2024-12-31 23:00:00   0.0000    NA</span></span>
<span><span class="co">#&gt; 10 2024-12-31 23:30:00   0.0000    NA</span></span>
<span><span class="co">#&gt; 11 2025-01-01 00:00:00   0.0000 0.483</span></span>
<span><span class="co">#&gt; 12 2025-01-01 00:30:00   0.0000 0.518</span></span>
<span><span class="co">#&gt; 13 2025-01-01 01:00:00   0.0000 0.541</span></span>
<span><span class="co">#&gt; 14 2025-01-01 01:30:00   0.0000 0.476</span></span>
<span><span class="co">#&gt; 15 2025-01-01 02:00:00   0.0000 0.442</span></span>
<span><span class="co">#&gt; 16 2025-01-01 02:30:00   0.0000 0.438</span></span>
<span><span class="co">#&gt; 17 2025-01-01 03:00:00   0.0000 0.500</span></span>
<span><span class="co">#&gt; 18 2025-01-01 03:30:00   0.0000 0.449</span></span>
<span><span class="co">#&gt; 19 2025-01-01 04:00:00   0.0000 0.502</span></span>
<span><span class="co">#&gt; 20 2025-01-01 04:30:00   0.0000 0.478</span></span></code></pre></div>
<p>As shown above, the merged data contains ERA5 data in
<code>ssrd</code>, as well as AmeriFlux data in <code>SW_IN</code>.</p>
<p>Finally, you can blend the merged data.</p>
<p>The <code><a href="../reference/blend_ERA5_Flux.html">blend_ERA5_Flux()</a></code> function combines AmeriFlux and
ERA5 datasets into a single, gap-filled time series by applying flexible
blending rules that determine how missing or incomplete AmeriFlux data
should be replaced or adjusted using ERA5 values. Building on the merged
output from <code><a href="../reference/merge_ERA5_FLUX.html">merge_ERA5_FLUX()</a></code>, this function allows users
to select among four blending approaches: simple replacement, linear
regression with or without an intercept, or an automatic rule that
adapts based on data completeness. For example, when more than half of
the AmeriFlux values are available, the function uses a regression-based
correction to preserve site-specific patterns while filling gaps;
otherwise, it substitutes ERA5 data directly. The blended output adds
new columns (e.g., <code>SW_IN_f</code>, <code>TA_f</code>) that contain
the harmonized variables, producing a continuous, high-quality dataset
suitable for modeling, data assimilation, or long-term flux-climate
analysis.</p>
<p>The final result will look something like this:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Specify the blending rule(s)</span></span>
<span><span class="va">blending_rule</span> <span class="op">&lt;-</span> <span class="st">"replace"</span></span>
<span></span>
<span><span class="co"># Blend them together</span></span>
<span><span class="va">blended_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/blend_ERA5_Flux.html">blend_ERA5_Flux</a></span><span class="op">(</span>merged_data <span class="op">=</span> <span class="va">merged_data</span>,</span>
<span>                                varname_FLUX <span class="op">=</span> <span class="va">ameriflux_var</span>,</span>
<span>                                varname_ERA5 <span class="op">=</span> <span class="va">era5_var</span>,</span>
<span>                                blending_rule <span class="op">=</span> <span class="va">blending_rule</span><span class="op">)</span></span>
<span><span class="co">#&gt; Processing: SW_IN using rule: replace</span></span>
<span></span>
<span><span class="va">blended_data</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">20</span>,<span class="op">]</span></span>
<span><span class="co">#&gt;                   time     ssrd SW_IN  SW_IN_f</span></span>
<span><span class="co">#&gt; 1  2024-12-31 19:00:00 663.4275    NA 663.4275</span></span>
<span><span class="co">#&gt; 2  2024-12-31 19:30:00 331.7138    NA 331.7138</span></span>
<span><span class="co">#&gt; 3  2024-12-31 20:00:00   0.0000    NA   0.0000</span></span>
<span><span class="co">#&gt; 4  2024-12-31 20:30:00   0.0000    NA   0.0000</span></span>
<span><span class="co">#&gt; 5  2024-12-31 21:00:00   0.0000    NA   0.0000</span></span>
<span><span class="co">#&gt; 6  2024-12-31 21:30:00   0.0000    NA   0.0000</span></span>
<span><span class="co">#&gt; 7  2024-12-31 22:00:00   0.0000    NA   0.0000</span></span>
<span><span class="co">#&gt; 8  2024-12-31 22:30:00   0.0000    NA   0.0000</span></span>
<span><span class="co">#&gt; 9  2024-12-31 23:00:00   0.0000    NA   0.0000</span></span>
<span><span class="co">#&gt; 10 2024-12-31 23:30:00   0.0000    NA   0.0000</span></span>
<span><span class="co">#&gt; 11 2025-01-01 00:00:00   0.0000 0.483   0.0000</span></span>
<span><span class="co">#&gt; 12 2025-01-01 00:30:00   0.0000 0.518   0.0000</span></span>
<span><span class="co">#&gt; 13 2025-01-01 01:00:00   0.0000 0.541   0.0000</span></span>
<span><span class="co">#&gt; 14 2025-01-01 01:30:00   0.0000 0.476   0.0000</span></span>
<span><span class="co">#&gt; 15 2025-01-01 02:00:00   0.0000 0.442   0.0000</span></span>
<span><span class="co">#&gt; 16 2025-01-01 02:30:00   0.0000 0.438   0.0000</span></span>
<span><span class="co">#&gt; 17 2025-01-01 03:00:00   0.0000 0.500   0.0000</span></span>
<span><span class="co">#&gt; 18 2025-01-01 03:30:00   0.0000 0.449   0.0000</span></span>
<span><span class="co">#&gt; 19 2025-01-01 04:00:00   0.0000 0.502   0.0000</span></span>
<span><span class="co">#&gt; 20 2025-01-01 04:30:00   0.0000 0.478   0.0000</span></span></code></pre></div>
<p>In this example, the simple replacement blending rule was used, so a
new <code>SW_IN_f</code> column was created with values from the ERA5
column, <code>ssrd</code>.</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Angel Chen, Sam Jurado, David E Reed, Ammara Talib, Junna Wang, Boya Zhang, Sparkle L Malone.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
