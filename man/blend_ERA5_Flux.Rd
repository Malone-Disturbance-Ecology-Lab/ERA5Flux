% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/03_02_blend_ERA5_FLUX.R
\name{blend_ERA5_Flux}
\alias{blend_ERA5_Flux}
\title{blend_ERA5_FLUX}
\usage{
blend_ERA5_Flux(merged_data, varname_FLUX, varname_ERA5, blending_rule)
}
\arguments{
\item{merged_data:}{merged_data <- merge_ERA5_FLUX(filename_FLUX, filename_ERA5, varname_FLUX, varname_ERA5)
this dataframe has Datetime stamp column named "time" with the format: "\%Y-\%m-\%d \%H:\%M:\%S"
time step of the "time" column is the same with that of AmeriFlux file
It also includes the columns of varname_FLUX, the columns of varname_ERA5
varname_FLUX: variable names in AmeriFlux BASE data to be blended with ERA5 data
varname_ERA5: variable names in ERA5 data to be blended with AmeriFlux BASE data
please note that the length of varname_FLUX must be the same as the length of varname_ERA5; at the same location, varname_FLUX and varname_ERA5 should refer to the same variable despite AmeriFlux and ERA5 may use different names for the same variable. For example, for incoming shortwave radiation, ERA5 uses ssrd, but AmeriFlux uses SW_IN.
blending_rule: There are four types of blending rules that can be used to blend AmeriFlux and ERA5 variables

\if{html}{\out{<div class="sourceCode">}}\preformatted{           'lm': linear regression with slope
                 Fits a linear model with slope: FLUX ~ ERA5, then Only fills missing values in FLUX with predicted values from ERA5.

           'lm_no_intercept': linear regression without slope
                              Fits a linear model with slope: FLUX ~ ERA5, then Only fills missing values in FLUX with predicted values from ERA5.   

           'replace' : replace Ameriflux variable with ERA5 variable

           'automatic' : Checks for non-missing FLUX values
                          If â‰¥50\% present then uses "lm" approach
                          If <50\% present then fallback to "replace"
}\if{html}{\out{</div>}}}
}
\value{
dataframe with the following characteristics:

time step of the "time" column is the same with that of AmeriFlux file;
It also includes the columns of varname_FLUX, the columns of varname_ERA5
variable column with applying blending rule applied on it. name of blended column is simialr to Ameriflux column name but with addition of "_f"
}
\description{
this function is used to blend data from AmeriFlux and data from ERA5, ensuring they have the same start and end of timestamp and timestep with AmeriFlux data
Please first make sure to run the merge function (03_01_merge_ERA5_FLUX.R) first, because output of merge function will be used as input of this blending function
}
\examples{

first example
Please first make sure to run the merge function (03_01_merge_ERA5_FLUX.R) first, because output of merge function will be used as input of this blending function
filename_FLUX <- system.file("extdata", "AMF_BR-Sa1_BASE-BADM_5-5.zip", package = "ERA5Flux")
filename_ERA5 <- system.file("extdata", "BR-Sa1_tp_2002_2011.csv", package = "ERA5Flux")
varname_FLUX <- c("P")
varname_ERA5 <- c("tp")
merged_data <- merge_ERA5_FLUX(filename_FLUX, filename_ERA5, varname_FLUX, varname_ERA5)                    
blending_rule <- c('lm_no_intercept')                 
merg_blend <- blend_ERA5_Flux(merged_data, varname_FLUX, varname_ERA5, blending_rule)

second example
filename_FLUX <- system.file("extdata", "AMF_US-EvM_BASE-BADM_2-5.zip", package = "ERA5Flux")
filename_ERA5 <- system.file("extdata", "US-EvM_ERA_2020_2023_hr.csv", package = "ERA5Flux")
varname_FLUX <- c('SW_IN', 'TA')
varname_ERA5 <- c('ssrd', 't2m')
merged_data <- merge_ERA5_FLUX(filename_FLUX, filename_ERA5, varname_FLUX, varname_ERA5)                   
blending_rule <- c('replace', 'automatic')                 
merg_blend <- blend_ERA5_Flux(merged_data, varname_FLUX, varname_ERA5, blending_rule)

}
\author{
Ammara Talib and Junna Wang
}
