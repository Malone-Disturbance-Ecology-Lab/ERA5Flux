<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Merge ERA5 and AmeriFlux Data — merge_ERA5_FLUX • ERA5Flux</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Merge ERA5 and AmeriFlux Data — merge_ERA5_FLUX"><meta name="description" content="This function is used to merge data from AmeriFlux and data from ERA5, ensuring they both have the same start and end timestamps."><meta property="og:description" content="This function is used to merge data from AmeriFlux and data from ERA5, ensuring they both have the same start and end timestamps."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ERA5Flux</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/Malone-Disturbance-Ecology-Lab/ERA5Flux/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Merge ERA5 and AmeriFlux Data</h1>
      <small class="dont-index">Source: <a href="https://github.com/Malone-Disturbance-Ecology-Lab/ERA5Flux/blob/main/R/03_01_merge_ERA5_FLUX.R" class="external-link"><code>R/03_01_merge_ERA5_FLUX.R</code></a></small>
      <div class="d-none name"><code>merge_ERA5_FLUX.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function is used to merge data from AmeriFlux and data from ERA5, ensuring they both have the same start and end timestamps.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">merge_ERA5_FLUX</span><span class="op">(</span></span>
<span>  filename_FLUX <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  filename_ERA5 <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  varname_FLUX <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  varname_ERA5 <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-filename-flux">filename_FLUX<a class="anchor" aria-label="anchor" href="#arg-filename-flux"></a></dt>
<dd><p>(character) The file path to AmeriFlux BASE data downloaded from https://ameriflux.lbl.gov/.</p></dd>


<dt id="arg-filename-era-">filename_ERA5<a class="anchor" aria-label="anchor" href="#arg-filename-era-"></a></dt>
<dd><p>(character) The file path to a CSV file of meterological data downloaded from ERA5 https://cds.climate.copernicus.eu/datasets/reanalysis-era5-single-levels?tab=overview. Please note that the original ERA5 files are in .nc format. You may want to convert these files into CSV format using the function <code><a href="netcdf_to_csv.html">netcdf_to_csv()</a></code>.</p></dd>


<dt id="arg-varname-flux">varname_FLUX<a class="anchor" aria-label="anchor" href="#arg-varname-flux"></a></dt>
<dd><p>(character) A vector of variable names in AmeriFlux BASE data to be merged with ERA5 data.</p></dd>


<dt id="arg-varname-era-">varname_ERA5<a class="anchor" aria-label="anchor" href="#arg-varname-era-"></a></dt>
<dd><p>(character) A vector of variable names in ERA5 data to be merged with AmeriFlux BASE data.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>(data.frame) A data frame with the following characteristics:</p><ul><li><p>Datetime stamp column named "time" with the format: "%Y-%m-%d %H:%M:%S".</p></li>
<li><p>Time step of the "time" column is the same with that of AmeriFlux file.</p></li>
<li><p>It also includes the columns of <code>varname_FLUX</code>, the columns of <code>varname_ERA5</code>.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>Please note that the length of <code>varname_FLUX</code> must be the same as the length of <code>varname_ERA5</code>; at the same location, <code>varname_FLUX</code> and <code>varname_ERA5</code> should refer to the same variable despite the fact that AmeriFlux and ERA5 may use different names for the same variable. For example, for incoming shortwave radiation, ERA5 uses "ssrd", but AmeriFlux uses "SW_IN".</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Ammara Talib and Junna Wang</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># First example</span></span></span>
<span class="r-in"><span><span class="co"># Point to AmeriFlux data</span></span></span>
<span class="r-in"><span><span class="va">filename_FLUX</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"AMF_BR-Sa1_BASE-BADM_5-5.zip"</span>, package <span class="op">=</span> <span class="st">"ERA5Flux"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Point to ERA5 data</span></span></span>
<span class="r-in"><span><span class="va">filename_ERA5</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"BR-Sa1_tp_2002_2011.csv"</span>, package <span class="op">=</span> <span class="st">"ERA5Flux"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># List AmeriFlux variable(s) to be merged with ERA5</span></span></span>
<span class="r-in"><span><span class="va">varname_FLUX</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"P"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># List ERA5 variable(s) to be merged with AmeriFlux</span></span></span>
<span class="r-in"><span><span class="va">varname_ERA5</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"tp"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Merge AmeriFlux and ERA5 data together</span></span></span>
<span class="r-in"><span><span class="va">merged_data</span> <span class="op">&lt;-</span> <span class="fu">merge_ERA5_FLUX</span><span class="op">(</span><span class="va">filename_FLUX</span>, <span class="va">filename_ERA5</span>, <span class="va">varname_FLUX</span>, <span class="va">varname_ERA5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">merged_data</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                  time        tp  P</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 2002-01-01 00:00:00 0.2252227 NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 2002-01-01 01:00:00 0.4244113 NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 2002-01-01 02:00:00 0.3902548 NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 2002-01-01 03:00:00 0.6315456 NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 2002-01-01 04:00:00 0.2987110 NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 2002-01-01 05:00:00 0.3121161 NA</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Second example</span></span></span>
<span class="r-in"><span><span class="co"># Point to AmeriFlux data</span></span></span>
<span class="r-in"><span><span class="va">filename_FLUX</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"AMF_US-EvM_BASE-BADM_2-5.zip"</span>, package <span class="op">=</span> <span class="st">"ERA5Flux"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Point to ERA5 data</span></span></span>
<span class="r-in"><span><span class="va">filename_ERA5</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"US-EvM_ERA_2020_2023_hr.csv"</span>, package <span class="op">=</span> <span class="st">"ERA5Flux"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># List AmeriFlux variable(s) to be merged with ERA5</span></span></span>
<span class="r-in"><span><span class="va">varname_FLUX</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'SW_IN'</span>, <span class="st">'TA'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># List ERA5 variable(s) to be merged with AmeriFlux</span></span></span>
<span class="r-in"><span><span class="va">varname_ERA5</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'ssrd'</span>, <span class="st">'t2m'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Merge AmeriFlux and ERA5 data together</span></span></span>
<span class="r-in"><span><span class="va">merged_data</span> <span class="op">&lt;-</span> <span class="fu">merge_ERA5_FLUX</span><span class="op">(</span><span class="va">filename_FLUX</span>, <span class="va">filename_ERA5</span>, <span class="va">varname_FLUX</span>, <span class="va">varname_ERA5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">merged_data</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                  time ssrd      t2m SW_IN TA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 2020-01-01 00:00:00    0 22.04965    NA NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 2020-01-01 00:30:00    0 21.83630    NA NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 2020-01-01 01:00:00    0 21.62295    NA NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 2020-01-01 01:30:00    0 21.40405    NA NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 2020-01-01 02:00:00    0 21.18514    NA NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 2020-01-01 02:30:00    0 20.99367    NA NA</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Angel Chen, Sam Jurado, David E Reed, Ammara Talib, Junna Wang, Boya Zhang, Sparkle L Malone.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

